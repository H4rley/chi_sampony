<!-- Page Content -->
<div class="container">
    <div class="row">
        <div class="col-lg-12">
            <h1><%= I18n.t :chi_shampoos %></h1>
        </div>
    </div>

    <div id='portfolio'>
        <div class="row">
            <div class="col-lg-12 text-center">
                <h2 class="section-heading">Portfolio</h2>
                <h3 class="section-subheading text-muted"><%= I18n.t :choose_your_best_suite%></h3>
            </div>
        </div>
        <div class="row">
        <% @products.each do |product| %>
            <div class="col-md-3 col-sm-6 portfolio-item">
                <a href=<%="#{product_path(product)}"%> class="portfolio-link" data-toggle="modal">
                    <div class="portfolio-hover">
                        <div class="portfolio-hover-content">
                            <i class="fa fa-plus fa-3x"></i>
                        </div>
                    </div>
                    <%= image_tag product.image, class: "img-responsive" %>
                </a>
                <div class='portfolio-caption'>
                      <h4><%= product.name.capitalize %></h4>
                      <div><%= product.price %> â‚¬</div>  
                    <p class="text-muted"><%#= product.description %></p>
                </div>
                <div style='text-align: center;'>
                    <button class='btn addToCardIcon' data-id=<%=product.id%> data-toggle="popover">
                        <span class="glyphicon glyphicon-shopping-cart"></span>
                    Add to card
                </button>
                </div>
            </div>
        <% end %>
    </div>
    </div>

</div>
<!-- /.container -->

<script>
$(document).ready(function(){


$('.addToCardIcon').click(function() {
    var product = this
    var id = $(this).data('id')
    if (!$('.popover').is(':visible'))    
      $.ajax({
          url: 'shopping_card',
          data: {id: id},
          method: 'POST',
          success:  function() {
                add_item_to_card()
                $('.glyphicon-remove').on('click', function() {                    
                    $(product).click();
                })
            }
          })
})

$('[data-toggle="popover"]').popover({
        title: 'Great!<span class="glyphicon glyphicon-remove" style="padding-left: 183px;"><span>',
        content: '<p>You successfully added product to your card, you can visit your <a href="/shopping_card">Shopping card</a> or continue shopping.</p>',
        html: true
});


function add_item_to_card() {
    var count_element = parseInt($('#items_count_in_card').text())
    count_element = count_element + 1;
    $('#items_count_in_card').text(count_element)
}


})

    
</script>


